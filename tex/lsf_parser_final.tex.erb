<%
def tbl_cell(cnt, escape = true)
  cnt = cnt.gsub('<br>', "\n").strip_html.strip
  cnt = cnt.escape_for_tex if escape
  cnt = cnt.gsub("\n", '\linebreak{}')
  cnt
end

def time_magic(s)
  s.gsub!(/([0-9]+)<sup><small>([0-9]+)<\/small><\/sup>/,  "\\time{\\1}{\\2}")
  s.gsub("-", "--")
end
%>

\pagestyle{empty}
\rowcolors{1}{gray!20}{white}
\marginsize{0.5cm}{0.5cm}{1cm}{-1cm}

\begin{landscape}

\begin{minipage}[b]{0.5\linewidth}
  \textbf{How To:}
  \begin{enumerate}
    \item ankreuzen WANN Du evalst
    \item Deinen MathPhys-Account \emph{oder} Deine E-Mail, falls Du keinen Acc hast
    \item Die Hörer schätzen (z.B. in die Veranstaltung gehen und zählen)
  \end{enumerate}
\end{minipage}
\hspace{0.5cm}
\begin{minipage}[b]{0.5\linewidth}
  \textbf{Deine Verantwortung:}
  \begin{compactitem}
    \item der Bogen im Seee stimmt (Dt/En, VL/Seminar)
    \item Hörerzahl im Seee stimmt
    \item Du sorgst in der Evalwoche ggf. für Ersatz, falls Du nicht kannst
    \item Du klüngelst mit den Profs bei Sonderwünschen
    \item Du weißt wo die Veranstaltung stattfindet
  \end{compactitem}
\end{minipage}





\renewcommand{\arraystretch}{1.5}
\renewcommand{\time}[2]{#1\textsuperscript{#2}}
\newcolumntype{Y}{>{\raggedright\arraybackslash}p}

\begin{longtable}[l]{Y{8cm}Y{5cm}Y{4cm}Y{4cm}p{3.8cm}p{1cm}}
\hline
Name             & DozentIn      & Raum    & Zeit                               & AccountName? & Hörer? \\
Beispiel-Seminar & Rebecca Schön & FS-Raum & $\Box$ \time{18}{15}-\time{18}{45} & beccy@       & 37     \\
\hline
\endhead

<% data.each do |d| %>
  <% next if (d.times.empty? || d.rooms.empty? || d.profs.empty?) %>
  <%= tbl_cell(d.name) %> &
  <%= tbl_cell(listProfs(d.profs)) %> &
  <%= tbl_cell(d.rooms.join("\n")) %> &
  <%= d.times.collect{|x| "$\\Box$ #{time_magic(x)}"}.join('\linebreak{}') %> &
  &
  \\
<% end %>
\end{longtable}

\renewcommand{\arraystretch}{1}

\end{landscape}
